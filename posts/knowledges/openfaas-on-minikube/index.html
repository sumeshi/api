{"title": "openfaas-on-minikube", "heading": "Minikube\u306bOpenFaaS\u3092\u30c7\u30d7\u30ed\u30a4\u3059\u308b", "path": "knowledges/openfaas-on-minikube", "html_text": "<h1>Minikube\u306bOpenFaaS\u3092\u30c7\u30d7\u30ed\u30a4\u3059\u308b</h1>\n<p>Ubuntu20.04, OpenFaaS\u4f7f\u3063\u3066\u307f\u305f\u304b\u3063\u305f\u306e\u3067\u3002</p>\n<h2>\u6982\u8981</h2>\n<p>\u304a\u3046\u3061\u30b5\u30fc\u30d0\u3067FaaS\u3057\u3066\uff5e\u3063\u3066\u601d\u3063\u3066\u305f\u3051\u3069\u6848\u5916\u9078\u629e\u80a2\u304c\u5c11\u306a\u3044\u3002\u6c17\u304c\u3059\u308b\u3002<br />\n\u601d\u3044\u3064\u304f\u306e\u306f\u4e0b\u8a18\u306e\u30c4\u30fc\u30eb\u985e\u3002</p>\n<ol>\n<li><a href=\"https://www.openfaas.com/\">OpenFaaS</a></li>\n<li><a href=\"https://localstack.cloud/\">LocalStack</a></li>\n<li><a href=\"https://knative.dev/docs/\">Knative</a></li>\n<li><a href=\"https://github.com/serverless/serverless\">serverless framework</a></li>\n</ol>\n<p>\u306a\u3093\u304b1\u304c\u4e00\u756a\u30b7\u30f3\u30d7\u30eb\u305d\u3046\u3002<br />\n\u3042\u3093\u307e\u308a\u8907\u96d1\u306a\u69cb\u6210\u306b\u3059\u308b\u3068Web\u30b5\u30fc\u30d0\u7acb\u3066\u305f\u307b\u3046\u304c\u697d\u305d\u3046\u3067\u672c\u672b\u8ee2\u5012\u306a\u306e\u3067\u3002</p>\n<h2>\u74b0\u5883</h2>\n<p>Proxmox\u4e0a\u306b\u69cb\u7bc9\u3057\u305fUbuntu 20.04\u306eVM<br />\nCPU\u306f2Core, RAM2GB\u3092\u5272\u308a\u5f53\u3066\u307e\u3057\u305f\u3002</p>\n<p>\u524d\u63d0\u6761\u4ef6\u3068\u3057\u3066docker\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3001\u4e00\u822c\u30e6\u30fc\u30b6\u6a29\u9650\u3067\u8d77\u52d5\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u3066\u3042\u308a\u307e\u3059\u3002</p>\n<h2>\u624b\u9806</h2>\n<p><a href=\"https://minikube.sigs.k8s.io/docs/start/\">minikube start</a></p>\n<p>Installation - Linux, x86-64, Stable, Debian package\u306b\u6cbf\u3063\u3066\u4f5c\u696d\u3057\u307e\u3059\u3002</p>\n<h3>kubectl\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb</h3>\n<pre><code class=\"language-bash\">sudo snap install kubectl --classic\n</code></pre>\n<h3>Minikube\u306e\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb</h3>\n<pre><code class=\"language-bash\">$ curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube_latest_amd64.deb\n$ sudo dpkg -i minikube_latest_amd64.deb\n\n$ minikube start\n$ minikube status\n</code></pre>\n<h3>OpenFaaS\u306enamespace\u3092\u8a2d\u5b9a</h3>\n<pre><code class=\"language-bash\">$ git clone https://github.com/openfaas/faas-netes\n$ cd faas-netes\n$ kubectl apply -f namespaces.yml\n$ kubectl get namespaces\n</code></pre>\n<h3>OpenFaaS\u306bBasic\u8a8d\u8a3c\u3092\u8a2d\u5b9a</h3>\n<pre><code class=\"language-bash\">$ kubectl -n openfaas create secret generic basic-auth --from-literal=basic-auth-user={{\u30e6\u30fc\u30b6\u540d}} --from-literal=basic-auth-password={{\u30d1\u30b9\u30ef\u30fc\u30c9}}\n</code></pre>\n<h3>OpenFaaS\u306e\u30c7\u30d7\u30ed\u30a4</h3>\n<pre><code class=\"language-bash\">$ kubectl apply -f ./yaml/\n</code></pre>\n<h3>minikube\u306e\u30dd\u30fc\u30c8\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0</h3>\n<p>minikube\u306eIP\u3092\u78ba\u8a8d</p>\n<pre><code class=\"language-bash\">$ minikube ip\n{{IP\u30a2\u30c9\u30ec\u30b9}}\n</code></pre>\n<p>\u30db\u30b9\u30c8\u306e80\u756a\u30dd\u30fc\u30c8\u3078\u306e\u30a2\u30af\u30bb\u30b9\u3092minikube\u306e31112\u30dd\u30fc\u30c8\u3078\u30d5\u30a9\u30ef\u30fc\u30c7\u30a3\u30f3\u30b0\u3059\u308b</p>\n<pre><code class=\"language-bash\">$ sudo iptables -t nat -A PREROUTING -p tcp --dport 80 -j DNAT --to-destination {{IP\u30a2\u30c9\u30ec\u30b9}}:31112\n$ sudo iptables -t nat -A POSTROUTING -p tcp -d {{IP\u30a2\u30c9\u30ec\u30b9}} --dport 31112 -j MASQUERADE\n$ sudo iptables -A FORWARD -p tcp -d {{IP\u30a2\u30c9\u30ec\u30b9}} --dport 31112 -j ACCEPT\n</code></pre>\n<h2>\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9\u306e\u78ba\u8a8d</h2>\n<p>http://{{\u30db\u30b9\u30c8\u306eIP\u30a2\u30c9\u30ec\u30b9}}:80 \u306b\u30a2\u30af\u30bb\u30b9\u3059\u308b</p>\n<h2>\u53c2\u8003</h2>\n<ul>\n<li><a href=\"https://al-batross.net/2021/04/06/openfaas-deploy-on-kubernetes/\">OpenFaas \u3092 Kubernetes \u4e0a\u306b\u30c7\u30d7\u30ed\u30a4\u3059\u308b</a></li>\n</ul>", "published_at": "2023-03-12"}